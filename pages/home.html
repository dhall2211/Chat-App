<!DOCTYPE html>
<html lang="de-formal">

<head>
  <title>ChatAppHome</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../home.css" />
</head>

<body onload="time()">
  <script>
    function time() {
      var time = new Date();
      document.getElementById("now-left").innerHTML = time.getDay() + "-" + time.getMonth() + "-" + time.getFullYear() + "," + time.getUTCHours() + ":" + time.getUTCMinutes();
      document.getElementById("now-right").innerHTML = time.getDay() + "-" + time.getMonth() + "-" + time.getFullYear() + "," + time.getUTCHours() + ":" + time.getUTCMinutes();
      setInterval(time(), 1000);
    }
  </script>

  <div class="header">
    <div class="logoarea">
      <div class="title">CCC</div>
      <p class="companyName">Coding Campus Chat</p>
    </div>
  </div>

  <script>
    const chats=[
      {
        text: 'hi',
        date: 'june 5 1995',
      },
      {
        text: 'yo',
        date: 'june 5 1995',
      },
      {
        text: 'whats up!!!',
        date: 'june 5 1995',
      },
    ];

    chats.map(chat)=> {
      // create div html, insert innerHTML
    }

    
    // Example POST method implementation:
    async function postData(url = '', data = {}) {
      // Default options are marked with *
      const response = await fetch(url, {
        method: 'POST', // *GET, POST, PUT, DELETE, etc.
        mode: 'cors', // no-cors, *cors, same-origin
        cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
        credentials: 'same-origin', // include, *same-origin, omit
        headers: {
          'Content-Type': 'application/json'
          // 'Content-Type': 'application/x-www-form-urlencoded',
        },
        redirect: 'follow', // manual, *follow, error
        referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
        body: JSON.stringify(data) // body data type must match "Content-Type" header
      });
      return response.json(); // parses JSON response into native JavaScript objects
    }

    function postMessage() {
      const message = document.getElementById("textInputField").value;
      postData('/sendChat', { msg: message });
    }



    async function getData(url) {
      const response = await fetch(url);
      const data = await response.json();
      return data;
    }

    function printMessage() {
      const message = getData('http://localhost3030/getChat');
      document.getElementById("receivedMessage").innerText = message;
    }

    setInterval(() => {
      printMessage();
    }, 10000);
    printMessage();

  </script>

  <div class="chat_room">
    <div class="container">
      <img src="../img/person.png" alt="others" style="width:100%;">
      <p id="receivedMessage"> </p>
      <span class="time-left" id="now-left"></span>
    </div>

    <div class="container darker">
      <img src="../img/person.png" alt="I" class="right" style="width:100%;">
      <div><input class="message" type="text" id="message" name="message">
      </div>
      <span class="time-right" id="now-right"></span>
    </div>
  </div>

  <div class="footer">
    <form action="#">
      <div class="footerContainer">
        <div><input class="text" type="text" id="textInputField" name="textfield"
            placeholder="Type your messages here.">
        </div>
        <div><input id="submitButton" type="submit" value="Send" onclick="postMessage()" />
        </div>
        <div><input id="submitButton" type="submit" value="Logout" onclick="logout()" />
        </div>
      </div>
    </form>
  </div>

</body>

</html>